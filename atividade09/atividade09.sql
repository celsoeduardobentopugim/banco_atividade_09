CREATE TABLE PRODUTO(
	ID SERIAL PRIMARY KEY,
	CODIGO VARCHAR(3),
	DESCRICAO VARCHAR(100),
	UNIDADEMEDIDA CHAR(2),
	VALOR NUMERIC (12,2),
	CUSTO NUMERIC (12,2),
	DATACADASTRO DATE,
	INATIVO BOOLEAN
);



--
--
INSERT INTO PRODUTO 
	(CODIGO,DESCRICAO,UNIDADEMEDIDA,VALOR,CUSTO,DATACADASTRO,INATIVO)
VALUES 
	('P01','Refrigerante 2L',	'UN',	 5.99, 4.00, 	'10/01/2022',	FALSE);

-- Alterando a tabela para incluir a CONSTRAINT: UNIQUE para a COLUNA (CODIGO)
ALTER TABLE PRODUTO 
ADD CONSTRAINT UQ_PRODUTO_CODIGO UNIQUE (CODIGO);

INSERT INTO PRODUTO 
	(CODIGO,DESCRICAO,UNIDADEMEDIDA,VALOR,CUSTO,DATACADASTRO,INATIVO)
VALUES
	('P02','Alface','KG',0.99, 0.70, 		'10/01/2022',	FALSE),
	('P03','Arroz 5KG','UN',19.99,18.59, 	'10/01/2022',	FALSE),
	('P04','Feijao 1KG','UN',5.99,4.99, 	'10/01/2022',	FALSE),
	('P05','Cerveja 600ML','UN',2.99,2.49, 	'12/02/2022',	FALSE),
	('P06','Amendoim 500G','UN',2.50,2.00, 	'12/02/2022',	FALSE),
	('P07','Pipoca 200G','UN',4.00,3.00, 	'12/02/2022',	FALSE),
	('P08','Pacote Bala 1KG','UN',7.89,6.50,'24/12/2021',	FALSE),
	('P09','Uva','KG',4.50,3.00,			'24/12/2021',	FALSE),
	('P10','Abacaxi','KG',1.99,1.50,		'24/12/2021',	FALSE),
	('P11','Pipoca Doce 200G','UN',1.50,4.50,CURRENT_DATE,'FALSE'),
	('P12','Sucrilhos 500G','UN',6.00,8.99,CURRENT_DATE,'FALSE');


ALTER TABLE PRODUTO 
ADD COLUMN TIPO VARCHAR(50);



UPDATE PRODUTO SET TIPO = 'Bebidas' WHERE ID = 1;
UPDATE PRODUTO SET TIPO = 'Bebidas' WHERE CODIGO = 'P01';

UPDATE PRODUTO SET TIPO = 'Bebidas' WHERE ID = 5;
UPDATE PRODUTO SET TIPO = 'Bebidas' WHERE CODIGO = 'P05';

SELECT * FROM PRODUTO;

UPDATE PRODUTO SET TIPO = 'Doces' WHERE CODIGO = 'P08';

UPDATE PRODUTO SET TIPO = 'Farinaceos' WHERE ID in (3,4,6,7,11,12);

UPDATE PRODUTO SET TIPO = 'Feira' WHERE ID = 9 OR ID = 2 OR ID = 10;


-- Adicionado COLUNA (QTDESTOQUE) na TABELA PRODUTO
ALTER TABLE PRODUTO 
ADD COLUMN QTDESTOQUE FLOAT;


-- Atualizando os dados de estoque!
UPDATE PRODUTO SET QTDESTOQUE = 400 	 WHERE ID = 1;
UPDATE PRODUTO SET QTDESTOQUE = 80.500   WHERE ID = 2;
UPDATE PRODUTO SET QTDESTOQUE = 875 	 WHERE ID = 3;
UPDATE PRODUTO SET QTDESTOQUE = 380		 WHERE ID = 4;
UPDATE PRODUTO SET QTDESTOQUE = 4555	 WHERE ID = 5;
UPDATE PRODUTO SET QTDESTOQUE = 100		 WHERE ID = 6;
UPDATE PRODUTO SET QTDESTOQUE = 199		 WHERE ID = 7;
UPDATE PRODUTO SET QTDESTOQUE = 75		 WHERE ID = 8;
UPDATE PRODUTO SET QTDESTOQUE = 20.100	 WHERE ID = 9;
UPDATE PRODUTO SET QTDESTOQUE = 35.900	 WHERE ID = 10;
UPDATE PRODUTO SET QTDESTOQUE = 150		 WHERE ID = 11;
UPDATE PRODUTO SET QTDESTOQUE = 80		 WHERE ID = 12;



------------------------------------------------------------------------------------
-- TABELA CLIENTE


--
CREATE TABLE CLIENTE(
	NOME VARCHAR(200),
	CODIGO VARCHAR(3),
	CPF VARCHAR(11),
	TELEFONE VARCHAR(12),
	DATACADASTRO DATE,
	OBSERVACOES VARCHAR(30),
	INATIVO BOOLEAN
);




INSERT INTO CLIENTE (NOME, CODIGO, CPF, TELEFONE, DATACADASTRO, OBSERVACOES, INATIVO) 
VALUES 
    ('Maria Silva', 'C01', '12345678910', '43 34721122', '01/12/2021', 'Cliente Bom', FALSE),
    ('Jo√£o Santos', 'C02', '98765432100', '43 34723020', '01/12/2021', 'Cliente Bom', FALSE),
    ('Ana Costa', 'C03', '45678912345', '43 34721152', '14/01/2022', 'Cliente Inadimplente', FALSE),
    ('Pedro Souza', 'C04', '32165498711', '43 34721011', '14/01/2022', 'Cliente Regular', FALSE),
    ('Lucas Ferreira', 'C05', '74185296300', '43 34728085', '14/01/2022', 'Cliente Regular', FALSE),
    ('Julia Oliveira', 'C06', '36925814722', '43 34722310', '06/06/2021', 'Cliente Excelente', FALSE);
	

ALTER TABLE CLIENTE
ADD COLUMN ID SERIAL PRIMARY KEY;


-------------------------------
-- OUTRA FORMA CRIANDO SEPARADAMENTE COLUNA e DEPOIS CONSTRAINT PK, PERMITINDO INFORMAR UM NOME PARA CONSTRAINT

/*

ALTER TABLE CLIENTE
ADD COLUMN ID SERIAL;

ALTER TABLE CLIENTE
ADD CONSTRAINT PK_CLIENTE PRIMARY KEY (ID);

*/

SELECT * FROM PRODUTO;
SELECT * FROM CLIENTE;

--01

SELECT 
    CODIGO, 
    DESCRICAO, 
    TO_CHAR(VALOR, 'L999G999G990D99') AS VALOR, 
    TO_CHAR(CUSTO, 'L999G999G990D99') AS CUSTO, 
    TO_CHAR((VALOR - CUSTO), 'L999G999G990D99') AS LUCRO
FROM 
    PRODUTO;

--02

SELECT 
    CODIGO, 
    DESCRICAO, 
    VALOR::MONEY,
    CUSTO::MONEY,
    (VALOR - CUSTO)::MONEY AS LUCRO
FROM 
    PRODUTO
WHERE 
    (VALOR - CUSTO) < 0;

--03

SELECT 
	CODIGO,
	DESCRICAO,
	VALOR::MONEY,
	VALOR * 0.60::MONEY AS VLR_REAJUSTE,
	(VALOR + (VALOR *0.60))::MONEY VALOR_REAJUSTADO
FROM
	PRODUTO
WHERE
	 (VALOR - CUSTO) < 0;

--04
UPDATE 
	PRODUTO SET CUSTO = (CUSTO / 2)
WHERE
	CODIGO = 'P11' OR CODIGO = 'P12' RETURNING *

--05

SELECT 
    CODIGO, 
    DESCRICAO, 
    TO_CHAR(DATACADASTRO, 'DD/MM/YYYY') AS DATACADASTRO,
    TO_CHAR(VALOR, 'L999G999G990D99') AS VALOR, 
    TO_CHAR(CUSTO, 'L999G999G990D99') AS CUSTO, 
    TO_CHAR((VALOR - CUSTO), 'L999G999G990D99') AS LUCRO
FROM 
    PRODUTO;
--06

SELECT 
    CODIGO, 
    DESCRICAO, 
    TO_CHAR(DATACADASTRO, 'DD/MM/YYYY') AS DATACADASTRO,
    TO_CHAR(VALOR, 'L999G999G990D99') AS VALOR, 
    TO_CHAR(CUSTO, 'L999G999G990D99') AS CUSTO, 
    TO_CHAR((VALOR - CUSTO), 'L999G999G990D99') AS LUCRO
FROM 
    PRODUTO
WHERE 
    (VALOR - CUSTO) <= 1.00;
--07

ALTER TABLE PRODUTO
ADD COLUMN IMPOSTO NUMERIC(10,2);

SELECT * FROM PRODUTO;

UPDATE PRODUTO SET IMPOSTO = (CUSTO * 0.15)
WHERE TIPO = 'Bebidas' RETURNING *;

UPDATE PRODUTO SET IMPOSTO = (CUSTO * 0.12)
WHERE TIPO = 'Farinaceos' RETURNING *;

UPDATE PRODUTO SET IMPOSTO = (CUSTO * 0.14)
WHERE TIPO = 'Doces' RETURNING *;

UPDATE PRODUTO SET IMPOSTO = (CUSTO * 0.00)
WHERE TIPO = 'Feira' RETURNING *;

SELECT * FROM PRODUTO;





--08

SELECT 
	CODIGO,
	DESCRICAO,
	UNIDADEMEDIDA,
	VALOR::MONEY,
	CUSTO::MONEY,
	(CUSTO + IMPOSTO)::MONEY CUSTO_REAL,
	(VALOR - (CUSTO + IMPOSTO ))::MONEY LUCRO_REAL
FROM
	PRODUTO

--09

SELECT 
    DESCRICAO, 
    TO_CHAR(DATACADASTRO, 'DD/MM/YYYY') AS DATACADASTRO
FROM 
    PRODUTO
WHERE 
    EXTRACT(MONTH FROM DATACADASTRO) = 2 AND
    EXTRACT(YEAR FROM DATACADASTRO) = 2022 AND
    qtdestoque > 100;
	
--10

ALTER TABLE PRODUTO
ADD COLUMN CUSTO_REAL NUMERIC(10,2);

ALTER TABLE PRODUTO
ADD COLUMN LUCRO_REAL NUMERIC(10,2);

SELECT * FROM PRODUTO;

UPDATE PRODUTO SET CUSTO_REAL = (CUSTO + IMPOSTO) RETURNING *;

UPDATE PRODUTO SET LUCRO_REAL = (VALOR - (CUSTO + IMPOSTO )) RETURNING *;

